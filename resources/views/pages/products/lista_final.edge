<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Produtos - ChamaMerce</title>
  <style>
    .btn-edit-profile {
      background: #4a90e2;
      color: white;
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1rem;
      text-decoration: none;
    }
    .btn-edit-profile:hover {
      background: #357abd;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f5f7fa;
      min-height: 100vh;
    }
    
    .header {
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      color: white;
      padding: 1.5rem 2rem;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .header h1 {
      font-size: 1.8rem;
    }
    
    .header-right {
      display: flex;
      gap: 1.5rem;
      align-items: center;
    }
    
    .admin-badge {
      background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
      padding: 0.4rem 1rem;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 600;
    }
    
    .btn-logout {
      background: #e74c3c;
      color: white;
      border: none;
      padding: 0.6rem 1.5rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
    }
    
    .btn-logout:hover {
      background: #c0392b;
      transform: translateY(-2px);
    }
    
    .container {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 0 2rem;
    }
    
    h2 {
      color: #2c3e50;
      margin-bottom: 2rem;
      font-size: 2rem;
    }
    
    .btn-create {
      display: inline-block;
      background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
      color: white;
      padding: 0.9rem 2rem;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      margin-bottom: 2rem;
      transition: all 0.3s;
    }
    
    .btn-create:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(39, 174, 96, 0.3);
    }
    
    .success-message {
      background: #d4edda;
      color: #155724;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      margin-bottom: 1.5rem;
      border-left: 4px solid #28a745;
    }
    
    .error-message {
      background: #f8d7da;
      color: #721c24;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      margin-bottom: 1.5rem;
      border-left: 4px solid #dc3545;
    }
    
    .product-card {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s;
    }
    
    .product-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.12);
    }
    
    .product-info h3 {
      color: #2c3e50;
      margin-bottom: 0.5rem;
      font-size: 1.4rem;
    }
    
    .product-price {
      color: #27ae60;
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }
    
    .product-stock {
      color: #7f8c8d;
      font-size: 0.95rem;
    }

    .product-actions {
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }
    
    .btn-view {
      background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
      color: white;
      padding: 0.7rem 1.5rem;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s;
    }
    
    .btn-view:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
    }

    .btn-add-cart {
      background: #2ecc71;
      color: white;
      padding: 0.7rem 1.5rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
    }

    .btn-add-cart:hover {
      background: #27ae60;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(46, 204, 113, 0.4);
    }
    
    .no-products {
      text-align: center;
      padding: 4rem 2rem;
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    
    .no-products h3 {
      color: #7f8c8d;
      margin-bottom: 1rem;
      font-size: 1.5rem;
    }
    
    .no-products p {
      color: #95a5a6;
    }

    .pagination {
      margin-top: 2rem;
      display: flex;
      justify-content: center;
      gap: 0.5rem;
    }

    .pagination a {
      padding: 0.6rem 1rem;
      border-radius: 8px;
      text-decoration: none;
      background: #ecf0f1;
      color: #2c3e50;
      font-weight: 600;
    }

    .pagination a.active {
      background: #2ecc71;
      color: white;
    }

    .pagination a.nav-btn {
      background: #3498db;
      color: white;
    }

  </style>
</head>
<body>
  <header class="header">
    <h1>üõí ChamaMerce</h1>
    <div class="header-right">
      <span>Ol√°, {{ auth.user.fullName }}</span>
      @if(auth.user.role === 'admin')
        <span class="admin-badge">ADMIN</span>
      @end
      <a href="/cart" style="color: white; text-decoration: none; font-size: 1.5rem;">üõí</a>
      <a href="/profile/edit" class="btn-edit-profile">Editar Perfil</a>
      <form action="/logout" method="POST" style="margin: 0;">
        {{ csrfField() }}
        <button type="submit" class="btn-logout">Sair</button>
      </form>
    </div>
  </header>
  
  <div class="container">
    <h2>Lista de Produtos</h2>
    
    @if(auth.user.role === 'admin')
      <a href="{{ route('products.create') }}" class="btn-create">+ Criar Novo Produto</a>
    @end
    
    @if(flashMessages.has('success'))
      <div class="success-message">
        ‚úì {{ flashMessages.get('success') }}
      </div>
    @end
    
    @if(flashMessages.has('error'))
      <div class="error-message">
        ‚ö†Ô∏è {{ flashMessages.get('error') }}
      </div>
    @end
    
    {{-- LISTA DE PRODUTOS --}}
    @if(products.length > 0)
      @each(product in products)
        <div class="product-card">
          <div class="product-info">
            <h3>{{ product.name }}</h3>
            <div class="product-price">R$ {{ product.price }}</div>
            <div class="product-stock">Estoque: {{ product.stock }} unidades</div>
          </div>
          
          {{-- BOT√ïES DE A√á√ÉO --}}
          <div class="product-actions">
            <a href="{{ route('products.show', [product.id]) }}" class="btn-view">Ver Detalhes</a>
            
            {{-- Bot√£o adicionar ao carrinho (todos podem) --}}
            <form action="{{ route('cart.add', [product.id]) }}" method="POST" style="margin: 0;">
              {{ csrfField() }}
              <button type="submit" class="btn-add-cart">
                üõí Adicionar
              </button>
            </form>
          </div>
        </div>
      @end
    @else
      <div class="no-products">
        <h3>Nenhum produto cadastrado</h3>
        @if(auth.user.role === 'admin')
          <p>Comece criando seu primeiro produto!</p>
        @end
      </div>
    @end

    {{-- PAGINA√á√ÉO (se tiver) --}}
    @if(meta && meta.lastPage > 1)
      <div class="pagination">
        @if(meta.currentPage > 1)
          <a href="?page={{ meta.currentPage - 1 }}" class="nav-btn">¬´ Anterior</a>
        @end

        @each(i in Array.from({ length: meta.lastPage }, (_, index) => index + 1))
          <a 
            href="?page={{ i }}" 
            class="{{ i === meta.currentPage ? 'active' : '' }}"
          >
            {{ i }}
          </a>
        @end

        @if(meta.currentPage < meta.lastPage)
          <a href="?page={{ meta.currentPage + 1 }}" class="nav-btn">Pr√≥xima ¬ª</a>
        @end
      </div>
    @end
  </div>
</body>
</html>